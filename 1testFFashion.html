<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activité TICE : L'Ultra Fast Fashion</title>
    <style>
        /* --- Polices et Style Général --- */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Lora:ital,wght@0,400;1,400&display=swap');

        :root {
            --primary-color: #005A9C; /* Bleu France */
            --secondary-color: #E1000F; /* Rouge Marianne */
            --background-color: #f4f4f9;
            --text-color: #333;
            --light-gray: #e9e9e9;
            --highlight-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --font-main: 'Poppins', sans-serif;
            --font-text: 'Lora', serif;
        }

        body {
            font-family: var(--font-main);
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Écrans initiaux --- */
        .fullscreen-form {
            text-align: center;
            padding: 30px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 500px;
        }
        
        .fullscreen-form h2 {
            color: var(--primary-color);
            margin-top: 0;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1rem;
        }

        .form-btn {
            font-family: var(--font-main);
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            background-color: var(--primary-color);
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .form-btn:hover {
            background-color: #004a80;
        }
        
        #student-info-screen { display: none; }

        /* --- Conteneur de l'Activité --- */
        .activity-wrapper {
            display: none;
            width: 95%;
            max-width: 1600px;
            height: 95vh;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            flex-direction: column;
        }

        #timer-bar {
            text-align: center;
            padding: 12px;
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
            background-color: #fff;
            border-bottom: 2px solid var(--light-gray);
            flex-shrink: 0;
        }

        .main-container {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
        }

        /* --- Colonnes --- */
        .column {
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .column-content {
            overflow-y: auto;
            padding: 25px;
        }

        /* Colonne de Gauche : Texte */
        .left-column {
            width: 66.66%;
            flex-shrink: 0;
            border-right: 2px solid var(--light-gray);
        }
        
        .left-column h1, .left-column h2 {
            text-align: justify;
        }
        
        .left-column h1 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-top: 0;
        }

        .left-column .column-content p {
            font-family: var(--font-text);
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: justify;
            margin-bottom: 1.5em;
        }

        .left-column .column-content p:first-of-type {
            font-style: italic;
            font-weight: 600;
            color: #555;
        }

        /* Colonne de Droite : QCM */
        .right-column {
            width: 33.33%;
            flex-shrink: 0;
        }
        
        .right-column-header {
            padding: 25px 25px 15px 25px;
            background: white;
            z-index: 10;
            border-bottom: 2px solid var(--light-gray);
            flex-shrink: 0;
        }

        .right-column-header h2 {
             margin: 0;
        }
        
        .qcm-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 25px;
        }

        .question-block {
            margin-bottom: 25px;
            border-left: 4px solid var(--light-gray);
            padding-left: 15px;
            transition: border-left-color 0.3s ease;
        }

        .question-block p {
            font-weight: 600;
            margin-bottom: 12px;
        }

        .answer-option {
            display: block;
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 5px;
            transition: background-color 0.2s ease, transform 0.2s ease;
            cursor: pointer;
        }

        .answer-option:hover {
            background-color: #eef7ff;
            transform: translateX(5px);
        }
        
        .answer-option input {
            margin-right: 10px;
        }
        
        .correct-answer::after {
            content: ' ✔️';
            color: var(--success-color);
            font-weight: bold;
            margin-left: 8px;
        }

        .button-container {
            text-align: center;
            padding: 20px 25px 10px 25px;
            background: white;
            border-top: 2px solid var(--light-gray);
            z-index: 10;
            flex-shrink: 0;
        }
        
        #verify-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }

        #verify-btn:hover {
            background-color: #c00;
        }
        
        #results {
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
        }

        /* --- Pop-up / Modal --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0s 0.4s;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.4s ease;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: scale(0.9);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .modal-term {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .modal-category {
            font-style: italic;
            color: #666;
            font-size: 1.1rem;
        }

        .modal-definition {
            font-family: var(--font-text);
            font-size: 1.1rem;
            line-height: 1.7;
            text-align: justify;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #888;
            line-height: 1;
            transition: color 0.2s;
        }
        .close-modal:hover{
            color: #000;
        }

    </style>
</head>
<body>

    <!-- Écran de Démarrage -->
    <div class="fullscreen-form" id="start-screen">
        <button id="start-btn" class="form-btn">Cliquez pour commencer l'exercice</button>
    </div>
    
    <!-- Formulaire d'information de l'étudiant -->
    <div class="fullscreen-form" id="student-info-screen">
        <h2>Vos informations</h2>
        <form id="student-form">
            <div class="form-group">
                <label for="firstname">Prénom</label>
                <input type="text" id="firstname" name="firstname" required>
            </div>
            <div class="form-group">
                <label for="lastname">Nom</label>
                <input type="text" id="lastname" name="lastname" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            <button type="submit" class="form-btn">Commencez le test</button>
             <p id="form-error" style="color:var(--danger-color); margin-top:10px;"></p>
        </form>
    </div>

    <!-- Contenu Principal de l'activité -->
    <div class="activity-wrapper" id="activity-wrapper">
        <div id="timer-bar">
            Temps restant : <span id="timer">30:00</span>
        </div>
        <div class="main-container" id="main-container">
            
            <!-- Colonne Gauche: Texte -->
            <div class="column left-column">
                <div class="column-content">
                    <h1>Ultra Fast Fashion : la révolution à bas coûts qui bouleverse la mode et la planète</h1>
                    <p>
                        À coup de t-shirts à deux euros et de milliers de nouveautés chaque jour, l’<span class="lexicon-term" data-term="ultra fast fashion">ultra fast fashion</span> a pris d’assaut l’<span class="lexicon-term" data-term="industrie textile">industrie textile</span>. Des plateformes comme Shein ou Temu, portées par un modèle économique redoutable, s’imposent avec des prix défiant toute concurrence et un <span class="lexicon-term" data-term="renouvellement">renouvellement</span> incessant des <span class="lexicon-term" data-term="collections">collections</span>. Cette <span class="lexicon-term" data-term="déferlante">déferlante</span> commerciale, si elle séduit de nombreux consommateurs, soulève des questions environnementales et sociales si vives que le <span class="lexicon-term" data-term="législateur">législateur</span>, comme le Sénat en France, tente désormais d’en freiner l’impact.
                    </p>
                    
                    <h2>Une machine de guerre technologique et logistique</h2>
                    <p>
                        Le secret de ces nouveaux géants réside dans leur maîtrise technologique. Loin du modèle traditionnel des <span class="lexicon-term" data-term="collections">collections</span> saisonnières initié par des enseignes comme Zara dans les années 1990, l’<span class="lexicon-term" data-term="ultra fast fashion">ultra fast fashion</span> fonctionne en temps réel. « Pour eux, l’intelligence artificielle n’est pas née avec ChatGPT. C’est leur ADN », analyse Laëtitia Lamari, spécialiste du commerce en ligne. Ces plateformes pilotées par la tech peuvent développer des produits en très petite quantité, parfois à partir d’un simple <span class="lexicon-term" data-term="prototype">prototype</span> généré par IA. « S’il y a des clics, l’<span class="lexicon-term" data-term="algorithme">algorithme</span> se met en branle et donne des indicateurs pour de la fabrication », explique l’experte. Les chiffres illustrent l’ampleur du phénomène. Sur une période de deux semaines, l’AFP a analysé qu’en moyenne, Shein mettait en ligne 7 220 nouvelles <span class="lexicon-term" data-term="références">références</span> par jour, toutes catégories confondues. À titre de comparaison, sur la même période, H&M proposait environ 290 nouveautés quotidiennes pour sa <span class="lexicon-term" data-term="collection">collection</span> femme. Ce <span class="lexicon-term" data-term="rythme effréné">rythme effréné</span> permet de concevoir, produire et expédier un vêtement en moins de sept jours, contre trois semaines pour la <span class="lexicon-term" data-term="fast fashion">fast fashion</span> classique. Pour sa défense, Shein affirme aligner sa production sur la demande, ce qui permettrait d’avoir peu de <span class="lexicon-term" data-term="stock">stock</span> et un <span class="lexicon-term" data-term="taux d'invendus">taux d'invendus</span> faible.
                    </p>

                    <h2>Un <span class="lexicon-term" data-term="fardeau environnemental">fardeau environnemental</span> dévastateur</h2>
                    <p>
                        Ce modèle économique a un <span class="lexicon-term" data-term="coût écologique">coût écologique</span> exorbitant. L’<span class="lexicon-term" data-term="industrie textile">industrie textile</span> est déjà l’une des plus polluantes, mais la « <span class="lexicon-term" data-term="mode jetable">mode jetable</span> » amplifie le désastre. La production repose massivement sur des <span class="lexicon-term" data-term="fibre synthétique">fibres synthétiques</span> dérivées du pétrole, comme le polyester, qui génèrent d’importantes <span class="lexicon-term" data-term="émission">émissions</span> de <span class="lexicon-term" data-term="gaz à effet de serre">gaz à effet de serre</span>. Selon Oxfam France, le secteur pourrait émettre 2,7 milliards de tonnes de CO2 par an d’ici 2030. Le cycle de vie de ces vêtements est tout aussi problématique. Lors des lavages, ils libèrent des <span class="lexicon-term" data-term="microparticules de plastique">microparticules de plastique</span> qui polluent les océans et nuisent à la faune marine. Le modèle est également très gourmand en eau, notamment pour la <span class="lexicon-term" data-term="teinture">teinture</span>, et les eaux usées, chargées de produits chimiques toxiques, sont souvent rejetées sans traitement adéquat dans les rivières. Finalement, ces habits éphémères finissent rapidement à la poubelle. Chaque année, un citoyen de l’Union européenne jette en moyenne 11 kg de <span class="lexicon-term" data-term="déchets textiles">déchets textiles</span>, soit un total de 5 millions de tonnes qui s’accumulent dans des décharges, notamment sur le continent africain.
                    </p>

                    <h2>Des conditions humaines bafouées</h2>
                    <p>
                        Derrière les <span class="lexicon-term" data-term="prix planchers">prix planchers</span> se cache une réalité sociale souvent sombre. Pour être vendus à des tarifs défiant toute concurrence, comme un t-shirt à 2,16 euros chez Shein, les vêtements sont fabriqués dans des pays en développement où les droits des travailleurs sont précaires. Les salaires y sont souvent trop bas pour subvenir aux besoins essentiels, et les normes de sécurité élémentaires sont bafouées, comme l’a tragiquement rappelé l’effondrement du Rana Plaza en 2013, qui a coûté la vie à plus de 1 100 ouvriers. Pire encore, des rapports font état du recours au <span class="lexicon-term" data-term="travail forcé">travail forcé</span>, notamment dans la région du Xinjiang en Chine où la minorité ouïghoure serait surexploitée. Le travail des enfants est également une réalité dans certaines usines. Interrogé, Shein conteste ces accusations et affirme s’engager « à garantir le traitement équitable et digne des travailleurs » et interdire le <span class="lexicon-term" data-term="travail forcé">travail forcé</span> dans sa <span class="lexicon-term" data-term="chaîne d'approvisionnement">chaîne d’approvisionnement</span>. Cette nouvelle ère de consommation perturbe durablement le marché, prenant des parts aux acteurs historiques et, comme le note Gildas Minvielle de l’Institut Français de la Mode, elle « perturbe la perception que les consommateurs ont des prix ». Aujourd’hui, « le juste prix ou le prix légitime pour un vêtement n’est plus le même qu’avant ».
                    </p>
                </div>
            </div>

            <!-- Colonne Droite: QCM -->
            <div class="column right-column">
                <div class="right-column-header">
                    <h2>Testez votre compréhension</h2>
                </div>
                <form id="qcm-form" class="qcm-container">
                    
                    <div class="question-block" id="q1">
                        <p>1. Quel est le principal moteur de l’ultra fast fashion selon le texte ?</p>
                        <label class="answer-option"><input type="radio" name="q1" value="a"> La maîtrise de la technologie et de l’intelligence artificielle.</label>
                        <label class="answer-option"><input type="radio" name="q1" value="b"> La production de vêtements en très grande quantité.</label>
                        <label class="answer-option"><input type="radio" name="q1" value="c"> La création de collections saisonnières traditionnelles en grande quantité.</label>
                    </div>
                    
                    <div class="question-block" id="q2">
                        <p>2. Comment les plateformes comme Shein optimisent-elles leur production ?</p>
                        <label class="answer-option"><input type="radio" name="q2" value="a"> Elles produisent en masse pour réduire les coûts.</label>
                        <label class="answer-option"><input type="radio" name="q2" value="b"> Elles fabriquent en petite quantité en fonction des clics et de la demande.</label>
                        <label class="answer-option"><input type="radio" name="q2" value="c"> Elles stockent de grandes quantités de vêtements pour répondre rapidement.</label>
                    </div>

                    <div class="question-block" id="q3">
                        <p>3. Comment le rythme de mise en ligne des nouvelles références chez Shein se compare-t-il à celui de la fast fashion traditionnelle comme H&M ?</p>
                         <label class="answer-option"><input type="radio" name="q3" value="a"> Shein renouvelle ses collections à un rythme similaire à celui de H&M.</label>
                         <label class="answer-option"><input type="radio" name="q3" value="b"> Shein renouvelle ses collections plus lentement que H&M, en se concentrant sur des collections saisonnières.</label>
                         <label class="answer-option"><input type="radio" name="q3" value="c"> Shein renouvelle ses collections beaucoup plus rapidement que H&M, avec un flux constant de nouveautés.</label>
                    </div>

                    <div class="question-block" id="q4">
                        <p>4. Pourquoi l’ultra fast fashion est-elle qualifiée de « mode jetable » ?</p>
                         <label class="answer-option"><input type="radio" name="q4" value="a"> Parce qu’elle utilise des matériaux recyclables.</label>
                         <label class="answer-option"><input type="radio" name="q4" value="b"> Parce qu’elle encourage les consommateurs à conserver leurs vêtements longtemps.</label>
                         <label class="answer-option"><input type="radio" name="q4" value="c"> Parce que les vêtements ont une durée de vie courte.</label>
                    </div>

                    <div class="question-block" id="q5">
                        <p>5. Quel est un impact environnemental majeur des vêtements de l’ultra fast fashion ?</p>
                         <label class="answer-option"><input type="radio" name="q5" value="a"> Ils libèrent des microparticules de plastique lors des lavages.</label>
                         <label class="answer-option"><input type="radio" name="q5" value="b"> Ils consomment peu d’eau grâce à des procédés écologiques.</label>
                         <label class="answer-option"><input type="radio" name="q5" value="c"> Ils sont fabriqués à partir de fibres naturelles non polluantes.</label>
                    </div>

                    <div class="question-block" id="q6">
                        <p>6. Quelle est une conséquence des rejets d’eaux usées dans la production textile ?</p>
                         <label class="answer-option"><input type="radio" name="q6" value="a"> Elles augmentent la consommation d’eau dans les usines.</label>
                         <label class="answer-option"><input type="radio" name="q6" value="b"> Elles contiennent des polluants.</label>
                         <label class="answer-option"><input type="radio" name="q6" value="c"> Elles sont toujours traitées avant d’être rejetées dans les rivières.</label>
                    </div>
                    
                    <div class="question-block" id="q7">
                        <p>7. Qu’est-ce que l’auteur veut montrer au travers de l’événement dramatique au Bangladesh en 2013 ?</p>
                         <label class="answer-option"><input type="radio" name="q7" value="a"> Les conséquences tragiques des conditions de travail précaires dans l’industrie textile.</label>
                         <label class="answer-option"><input type="radio" name="q7" value="b"> La demande d’amélioration des normes de sécurité dans les usines textiles depuis 2013.</label>
                         <label class="answer-option"><input type="radio" name="q7" value="c"> La réussite des efforts de Shein pour garantir la sécurité de ses ouvriers.</label>
                    </div>

                    <div class="question-block" id="q8">
                        <p>8. Comment Shein répond-elle aux accusations de travail forcé ?</p>
                         <label class="answer-option"><input type="radio" name="q8" value="a"> Elle admet l’utilisation du travail forcé mais promet des améliorations.</label>
                         <label class="answer-option"><input type="radio" name="q8" value="b"> Elle refuse de commenter les accusations.</label>
                         <label class="answer-option"><input type="radio" name="q8" value="c"> Elle nie les accusations et affirme garantir un traitement équitable.</label>
                    </div>

                    <div class="question-block" id="q9">
                        <p>9. Comment l’ultra fast fashion affecte-t-elle la perception des prix par les consommateurs ?</p>
                         <label class="answer-option"><input type="radio" name="q9" value="a"> Elle rend les consommateurs plus exigeants sur la qualité des vêtements.</label>
                         <label class="answer-option"><input type="radio" name="q9" value="b"> Elle modifie la notion du « juste prix » pour un vêtement.</label>
                         <label class="answer-option"><input type="radio" name="q9" value="c"> Elle n’a aucun impact sur la perception des prix.</label>
                    </div>

                    <div class="question-block" id="q10">
                        <p>10. Quel est un effet indirect de l’ultra fast fashion sur les acteurs historiques de la mode ?</p>
                         <label class="answer-option"><input type="radio" name="q10" value="a"> Ils augmentent leurs prix pour concurrencer les plateformes comme Shein.</label>
                         <label class="answer-option"><input type="radio" name="q10" value="b"> Ils adoptent tous le même modèle de production que l’ultra fast fashion.</label>
                         <label class="answer-option"><input type="radio" name="q10" value="c"> Ils perdent des parts de marché face à ces nouveaux géants.</label>
                    </div>
                     <div id="results"></div>
                </form>
               
                <div class="button-container">
                     <button type="button" id="verify-btn">Vérifier mes réponses</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal pour le lexique -->
    <div class="modal-overlay" id="lexicon-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h3 class="modal-term" id="modal-term-title"></h3>
                    <span class="modal-category" id="modal-term-category"></span>
                </div>
                <button class="close-modal" id="close-modal-btn">&times;</button>
            </div>
            <p class="modal-definition" id="modal-term-definition"></p>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {

            // --- URL OF THE GOOGLE SCRIPT TO BE REPLACED ---
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyW5U7rr1G_fZE4hcWzaisBBHOt4IhtdO2gOBF8WV5ZB4D9rk_zv-K0SgDQcfjzv4fk/exec';

            // --- DATA ---
            const lexiconData = {
                "algorithme": { cat: "n.m.", def: "Ensemble de règles et d'opérations informatiques qui traite des données pour produire un résultat spécifique (ex: prédire le succès d'un produit)." },
                "chaîne d'approvisionnement": { cat: "n.f.", def: "Ensemble du réseau et des étapes permettant de produire et de distribuer un produit, de la matière première jusqu'au client final." },
                "collection": { cat: "n.f.", def: "Ensemble de vêtements proposés à la vente, renouvelé très fréquemment dans l’ultra fast fashion." },
                "collections": { cat: "n.f.pl.", def: "Dans le contexte de la mode, ensemble de vêtements et d'accessoires créés par une marque pour une période donnée." },
                "conditions de travail": { cat: "n.f.pl.", def: "Environnement professionnel d'un employé, incluant son salaire, sa sécurité, ses horaires et le respect de ses droits." },
                "coût écologique": { cat: "n.m.", def: "Totalité des dommages et des impacts négatifs causés à l'environnement par la fabrication, le transport et l'utilisation d'un produit." },
                "déchets textiles": { cat: "n.m.pl.", def: "Ensemble des vêtements et autres produits en tissu qui ne sont plus utilisés et sont jetés." },
                "déferlante": { cat: "n.f.", def: "Arrivée massive et soudaine de produits sur le marché, comparable à une grande vague submergeant tout sur son passage." },
                "émission": { cat: "n.f.", def: "Rejet de gaz à effet de serre ou d’autres substances polluantes liées à la production textile." },
                "fardeau environnemental": { cat: "n.m.", def: "Expression imagée désignant le poids et les conséquences négatives qu'une activité industrielle fait peser sur l'environnement." },
                "fast fashion": { cat: "n.f.", def: "Mode de production de vêtements à bas coûts avec un renouvellement rapide des collections, popularisé dans les années 1990 par des marques comme Zara ou H&M." },
                "fibre synthétique": { cat: "n.f.", def: "Matériau artificiel, comme le polyester, utilisé dans la fabrication de vêtements à bas coût, mais polluant." },
                "gaz à effet de serre": { cat: "n.m.pl.", def: "Type de gaz (comme le dioxyde de carbone) qui, présent dans l'atmosphère, contribue au réchauffement climatique." },
                "industrie textile": { cat: "n.f.", def: "Secteur économique qui produit des vêtements et autres produits à base de tissus, souvent critiqué pour son impact environnemental et social." },
                "invendu": { cat: "n.m.", def: "Vêtement produit mais non vendu, que l’ultra fast fashion cherche à minimiser grâce à une production à la demande." },
                "législateur": { cat: "n.m.", def: "Personne ou organe institutionnel (comme un parlement ou un sénat) qui a le pouvoir de rédiger et de voter les lois." },
                "microparticules de plastique": { cat: "n.f.pl.", def: "Fragments de plastique de taille microscopique qui se détachent des vêtements synthétiques lors du lavage et polluent les écosystèmes aquatiques." },
                "mode jetable": { cat: "n.f.", def: "Synonyme de 'fast fashion', soulignant le caractère éphémère et la faible qualité des vêtements, conçus pour être jetés rapidement." },
                "prix planchers": { cat: "n.m.pl.", def: "Prix de vente extrêmement bas, souvent proches du coût de production minimal, utilisés pour attirer massivement les clients." },
                "prototype": { cat: "n.m.", def: "Modèle initial d’un vêtement créé pour tester sa popularité avant une production plus large." },
                "références": { cat: "n.f.pl.", def: "Terme commercial désignant les différents articles, produits ou modèles spécifiques qui sont mis en vente." },
                "renouvellement": { cat: "n.m.", def: "Action de remplacer régulièrement les vêtements disponibles à la vente par de nouveaux modèles." },
                "rythme effréné": { cat: "n.m.", def: "Cadence ou vitesse d'action extrêmement rapide, semblant presque incontrôlée." },
                "stock": { cat: "n.m.", def: "Quantité de vêtements produits et prêts à être vendus, souvent limitée dans l’ultra fast fashion pour réduire les invendus." },
                "taux d'invendus": { cat: "n.m.", def: "Pourcentage de la marchandise produite qui n'a pas été vendue aux consommateurs." },
                "teinture": { cat: "n.f.", def: "Processus d’ajout de couleur aux tissus, souvent polluant à cause des produits chimiques utilisés." },
                "travail forcé": { cat: "n.m.", def: "Travail ou service exigé d'une personne contre sa volonté et sous la menace d'une sanction ou d'une punition." },
                "ultra fast fashion": { cat: "n.f.", def: "Modèle économique de l'industrie textile qui pousse à l'extrême la rapidité de production et le bas coût de la 'fast fashion', avec un renouvellement quasi quotidien des produits." }
            };

            const correctAnswers = { q1: 'a', q2: 'b', q3: 'c', q4: 'c', q5: 'a', q6: 'b', q7: 'a', q8: 'c', q9: 'b', q10: 'c' };

            // --- DOM ELEMENTS ---
            const startScreen = document.getElementById('start-screen');
            const startBtn = document.getElementById('start-btn');
            const studentInfoScreen = document.getElementById('student-info-screen');
            const studentForm = document.getElementById('student-form');
            const activityWrapper = document.getElementById('activity-wrapper');
            const timerDisplay = document.getElementById('timer');
            const timerBar = document.getElementById('timer-bar');
            const lexiconTerms = document.querySelectorAll('.lexicon-term');
            const modal = document.getElementById('lexicon-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const verifyBtn = document.getElementById('verify-btn');
            const qcmForm = document.getElementById('qcm-form');
            const resultsDiv = document.getElementById('results');

            let timerInterval;
            let timeSpent = 0;

            // --- STEP MANAGEMENT ---
            startBtn.addEventListener('click', () => {
                startScreen.style.display = 'none';
                studentInfoScreen.style.display = 'block';
            });

            studentForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                // Local storage to prevent simple re-attempts
                if(localStorage.getItem('submitted_' + email)) {
                    document.getElementById('form-error').textContent = 'Vous avez déjà participé à cet exercice.';
                    return;
                }
                studentInfoScreen.style.display = 'none';
                activityWrapper.style.display = 'flex';
                startTimer(30 * 60);
            });

            function startTimer(duration) {
                let timer = duration;
                timerInterval = setInterval(() => {
                    timer--;
                    timeSpent++;
                    let minutes = parseInt(timer / 60, 10);
                    let seconds = parseInt(timer % 60, 10);
                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;
                    timerDisplay.textContent = minutes + ":" + seconds;

                    if (timer < 0) {
                        clearInterval(timerInterval);
                        timerBar.textContent = "Temps écoulé !";
                        timerBar.style.color = 'var(--danger-color)';
                        verifyAnswers();
                    }
                }, 1000);
            }

            // --- LEXICON MANAGEMENT ---
            lexiconTerms.forEach(term => {
                term.addEventListener('click', (e) => {
                    const termKey = e.target.dataset.term;
                    const termData = lexiconData[termKey];
                    if (termData) {
                        document.getElementById('modal-term-title').textContent = e.target.textContent;
                        document.getElementById('modal-term-category').textContent = `${termData.cat}`;
                        document.getElementById('modal-term-definition').textContent = termData.def;
                        modal.classList.add('visible');
                    }
                });
            });

            closeModalBtn.addEventListener('click', () => modal.classList.remove('visible'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('visible');
            });

            // --- QUIZ MANAGEMENT AND DATA SUBMISSION ---
            verifyBtn.addEventListener('click', verifyAnswers);
            
            function verifyAnswers() {
                clearInterval(timerInterval);
                verifyBtn.disabled = true;
                verifyBtn.textContent = 'Envoi en cours...';

                let score = 0;
                const totalQuestions = Object.keys(correctAnswers).length;

                for (const qId in correctAnswers) {
                    const questionBlock = document.getElementById(qId);
                    const selected = qcmForm.querySelector(`input[name="${qId}"]:checked`);
                    const correctAnswerValue = correctAnswers[qId];
                    const correctAnswerInput = qcmForm.querySelector(`input[name="${qId}"][value="${correctAnswerValue}"]`);
                    
                    if(correctAnswerInput) {
                        correctAnswerInput.parentElement.classList.add('correct-answer');
                    }

                    if (selected) {
                        if (selected.value === correctAnswerValue) {
                            score++;
                            questionBlock.style.borderLeftColor = 'var(--success-color)';
                        } else {
                            questionBlock.style.borderLeftColor = 'var(--danger-color)';
                        }
                    } else {
                         questionBlock.style.borderLeftColor = 'var(--danger-color)';
                    }
                }
                
                resultsDiv.textContent = `Votre score : ${score} / ${totalQuestions}`;
                resultsDiv.style.color = score > totalQuestions / 2 ? 'var(--success-color)' : 'var(--danger-color)';
                
                // Prepare and send data
                submitResults(score, totalQuestions);
            }

            function submitResults(score, totalQuestions) {
                const formData = new FormData();
                formData.append('date', new Date().toLocaleString('fr-FR'));
                formData.append('firstname', document.getElementById('firstname').value);
                formData.append('lastname', document.getElementById('lastname').value);
                formData.append('email', document.getElementById('email').value);
                formData.append('score', score);
                formData.append('total', totalQuestions);
                formData.append('timeSpent', `${Math.floor(timeSpent/60)}m ${timeSpent%60}s`);

                if (SCRIPT_URL === 'https://script.google.com/macros/s/AKfycbyW5U7rr1G_fZE4hcWzaisBBHOt4IhtdO2gOBF8WV5ZB4D9rk_zv-K0SgDQcfjzv4fk/exec') {
                    verifyBtn.textContent = 'Configuration requise';
                    resultsDiv.innerHTML += "<br><small style='color:red'>L'URL du script Google n'a pas été configurée.</small>";
                    return;
                }

                fetch(SCRIPT_URL, { method: 'POST', body: formData })
                    .then(response => response.json())
                    .then(data => {
                        if(data.result === 'success'){
                            verifyBtn.textContent = 'Résultats envoyés !';
                            verifyBtn.style.backgroundColor = 'var(--success-color)';
                            localStorage.setItem('submitted_' + document.getElementById('email').value, 'true');
                        } else {
                            verifyBtn.textContent = 'Erreur lors de l\'envoi';
                            verifyBtn.style.backgroundColor = 'var(--danger-color)';
                            resultsDiv.innerHTML += `<br><small style='color:red'>Erreur: ${data.error}</small>`;
                        }
                    })
                    .catch(error => {
                        verifyBtn.textContent = 'Erreur de connexion';
                        verifyBtn.style.backgroundColor = 'var(--danger-color)';
                        resultsDiv.innerHTML += `<br><small style='color:red'>Impossible de contacter le serveur. ${error}</small>`;
                    });
            }
        });
    </script>
</body>
</html>
